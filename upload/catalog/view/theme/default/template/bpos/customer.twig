<div class="container page customers">
    <div class="topbar-customer">
      <div class="title">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M8 10h8M8 14h5"/></svg>
        <h1>Customers</h1>
        <span class="badge" title="data freshness">POS</span>
      </div>
      <div class="stats">
        <div class="stat"><span class="muted">Total</span> <b id="stat-total">0</b></div>
        <div class="stat"><span class="muted">New (7d)</span> <b id="stat-new">0</b></div>
        <div class="stat"><span class="muted">Top Spender</span> <b id="stat-top">—</b></div>
      </div>
    </div>

    <div class="controls">
      <label class="input" aria-label="Search customers">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="M21 21l-3.5-3.5"></path></svg>
        <input id="q" type="search" placeholder="Search name, phone, email…" autocomplete="off" />
      </label>
      <select id="sort" class="select" aria-label="Sort customers">
        <option value="name">Sort: Name (A–Z)</option>
        <option value="latest">Sort: Latest Purchase</option>
        <option value="orders">Sort: Total Orders</option>
        <option value="spent">Sort: Total Spent</option>
      </select>
      <select id="filterGroup" class="select">
          <option value="">All Groups</option>
          {% for group in customer_groups %}
    <option value="{{ group.customer_group_id }}">{{ group.name }}</option>
  {% endfor %}
      </select>
      <button class="btn" id="addBtn">➕ Add Customer</button>
    </div>

    <div class="surface">
      <table id="grid" aria-label="Customer list">
        <thead>
          <tr>
            <th style="width:34%">Customer</th>
            <th style="width:26%">Contact</th>
            <th style="width:12%">Orders</th>
            <th style="width:16%">Last Purchase</th>
            <th style="width:12%">Total Spent</th>
            <th style="width:6%">Action</th>
          </tr>
        </thead>
        <tbody id="rows"></tbody>
      </table>
      <div class="table-footer">
        <div class="muted" id="hint">Showing <span id="showing">0</span> of <span id="total">0</span></div>
        <div class="pager" id="pager">
          <button class="page-btn" id="prev">Prev</button>
          <span id="pageNumbers" class="pager-numbers"></span>
          <button class="page-btn" id="next">Next</button>
        </div>
      </div>
    </div>
</div>
{# OLD #}

<link rel="stylesheet" href="catalog/view/theme/default/stylesheet/bpos_customer.css">
<script>
$(function(){
  $.getJSON('index.php?route=bpos/customer/customer_list', res=>{
    if(res.data){
      state.data = res.data.map(c=>({
        id:c.customer_id,
        name:c.name,
        phone:c.telephone,
        email:c.email,
        address:c.address,
        tier:c.tier,
        customer_group_id:c.customer_group_id,
        orders:c.orders,
        last:c.last,
        spent:c.spent,
        joined:c.joined,
        notes:c.notes||''
      }));
      apply();
    }
  });
});
</script>
